var main = {
	state: {width: 800, height: 800},
	mouse: {x: 100, y: 200, relX: 0, relY: 0, down: false},
	rect: function(x, y, w, h, color, angle) {
		main.context.save();
		main.context.translate(x, y);
		// main.context.rotate(angle);
		main.context.fillStyle = color;
		main.context.fillRect(0, 0, w, h);
		main.context.restore();
	},
	clear: function() {
		main.context.clearRect(0, 0, main.state.width, main.state.height);
	}
};

(function() {
	var jCanvas = $('canvas').css({width: main.state.width, height: main.state.height});
	var canvas = jCanvas[0];
	canvas.width = main.state.width;
	canvas.height = main.state.height;
	main.context = canvas.getContext('2d');
	
	jCanvas.mousemove(function(e) {
		main.mouse.relX = e.originalEvent.movementX || main.mouse.x - e.offsetX;
		main.mouse.relY = e.originalEvent.movementY || main.mouse.y - e.offsetY;
		main.mouse.x = e.offsetX;
		main.mouse.y = e.offsetY;
	});
	
	$(window).mousedown(function(e) {
		main.mouse.down = true;
	});
	
	$(window).mouseup(function(e) {
		main.mouse.down = false;
	});
	
	main.game = new Game();
	
	setInterval(function() {main.game.update();}, 33);
})();
